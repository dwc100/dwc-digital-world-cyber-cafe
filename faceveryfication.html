<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Access — Processing</title>
  <link rel="icon" type="image/png" sizes="32x32" href="https://i.ibb.co/1gQKw6b/56.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://i.ibb.co/1gQKw6b/56.png">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --blue: #00aaff;
      --purple: #7d3cff;
      --green: #28a745;
      --bg-gradient-start: #ffffff;
      --bg-gradient-mid1: #e6f0ff;
      --bg-gradient-mid2: #f5f0ff;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body, html {
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-mid1), var(--bg-gradient-mid2));
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
      color: #111;
    }

    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .card {
      width: 100%;
      max-width: 480px;
      padding: 40px;
      border-radius: 20px;
      background: linear-gradient(180deg, rgba(255 255 255 / 0.95), rgba(255 255 255 / 0.85));
      box-shadow: 0 12px 35px rgba(0, 0, 0, 0.15);
      border: 2px solid rgba(125, 60, 255, 0.3);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: clamp(28px, 6vw, 44px);
      background: linear-gradient(90deg, var(--blue), var(--purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 20px;
    }

    .loader {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 8px solid rgba(125, 60, 255, 0.3);
      border-top-color: var(--blue);
      margin: 20px auto;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loader-text {
      font-weight: 600;
      font-size: 16px;
      margin-top: 20px;
      color: #333;
      animation: textGlow 1.5s ease-in-out infinite alternate;
    }

    @keyframes textGlow {
      from { opacity: 0.6; }
      to { opacity: 1; }
    }

    .progress-bar {
      width: 100%;
      height: 12px;
      border-radius: 8px;
      background: rgba(0,0,0,0.1);
      margin-top: 25px;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      width: 0;
      background: linear-gradient(90deg, var(--blue), var(--purple));
      border-radius: 8px;
      transition: width 0.2s ease;
    }

    .success-text {
      margin-top: 20px;
      font-weight: 700;
      font-size: 18px;
      color: var(--green);
      display: none;
    }

    /* small fallback button if browser blocks sound */
    .sound-hint {
      margin-top: 14px;
      font-size: 14px;
      color: #555;
    }
    .enable-sound {
      display: inline-block;
      margin-top: 8px;
      padding: 8px 12px;
      border-radius: 8px;
      background: linear-gradient(90deg,var(--blue),var(--purple));
      color: #fff;
      font-weight: 600;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <main class="card">
    <h1>Admin Access</h1>
    <div class="loader" aria-hidden="true"></div>
    <div class="loader-text" id="loaderText">Initializing secure admin session…</div>
    <div class="progress-bar" aria-hidden="true">
      <div class="progress-bar-fill" id="progressFill"></div>
    </div>
    <div class="success-text" id="successText">✅ Access Granted — Redirecting...</div>

    <div id="soundFallback" style="display:none;">
      <div class="sound-hint">If you don't hear sound, click below to enable audio:</div>
      <button id="enableSound" class="enable-sound">Enable Sound</button>
    </div>
  </main>

  <script>
    (function() {
      const loaderText = document.getElementById('loaderText');
      const progressFill = document.getElementById('progressFill');
      const successText = document.getElementById('successText');
      const soundFallback = document.getElementById('soundFallback');
      const enableSoundBtn = document.getElementById('enableSound');

      const steps = [
        "Checking credentials…",
        "Validating session tokens…",
        "Loading admin privileges…",
        "Finalizing security checks…"
      ];

      let stepIndex = 0;
      let progress = 0;

      // Speak function using SpeechSynthesis (fallback to console)
      function speak(text) {
        try {
          if ('speechSynthesis' in window) {
            const u = new SpeechSynthesisUtterance(text);
            // choose a voice if available (optional)
            const voices = window.speechSynthesis.getVoices();
            if (voices && voices.length) {
              // prefer a neutral voice (may vary by browser)
              u.voice = voices.find(v => /en|default/i.test(v.lang)) || voices[0];
            }
            u.rate = 1; u.pitch = 1;
            // speak; returns immediately
            window.speechSynthesis.speak(u);
            return true;
          }
        } catch (e) {
          console.warn('TTS failed:', e);
        }
        return false;
      }

      // Small audible chime using WebAudio (may be blocked until user gesture)
      function playChime() {
        try {
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          const o = ctx.createOscillator();
          const g = ctx.createGain();
          o.type = 'sine';
          o.frequency.value = 880; // A5
          g.gain.value = 0.0001;
          o.connect(g);
          g.connect(ctx.destination);
          // ramp up quickly
          g.gain.linearRampToValueAtTime(0.12, ctx.currentTime + 0.01);
          o.start();
          // stop after 300ms
          setTimeout(() => {
            g.gain.exponentialRampToValueAtTime(0.00001, ctx.currentTime + 0.18);
            setTimeout(() => {
              o.stop();
              try { ctx.close(); } catch(e){}
            }, 200);
          }, 300);
          return true;
        } catch(e) {
          console.warn('WebAudio failed:', e);
          return false;
        }
      }

      // Try to play sound (TTS first, fallback to chime)
      function tryPlaySoundImmediate() {
        const ok = speak('Access granted');
        // If speechSynthesis queued but browser blocks audio, show fallback button
        // Also attempt chime if speech not supported
        if (!ok) {
          const chimeOk = playChime();
          if (!chimeOk) {
            soundFallback.style.display = 'block';
          }
        }
      }

      // Allow user to enable sound if blocked
      enableSoundBtn.addEventListener('click', () => {
        // user gesture now; try both
        playChime();
        speak('Access granted');
        soundFallback.style.display = 'none';
      });

      function runLoader() {
        // immediately try to play sound when page opens
        tryPlaySoundImmediate();

        const interval = setInterval(() => {
          progress += Math.random() * 6; // simulate loading
          if (progress > 100) progress = 100;
          progressFill.style.width = Math.round(progress) + '%';

          if (progress >= (stepIndex + 1) * 25 && stepIndex < steps.length) {
            loaderText.textContent = steps[stepIndex];
            stepIndex++;
          }

          if (progress >= 100) {
            clearInterval(interval);
            loaderText.style.display = 'none';
            successText.style.display = 'block';

            // play sound again on success (best effort)
            tryPlaySoundImmediate();

            // short delay then redirect
            setTimeout(() => {
              window.location.href = 'adminpage.html'; // redirect to admin page
            }, 1200);
          }
        }, 200);
      }

      // run on load
      window.addEventListener('load', runLoader);
    })();
  </script>
</body>
</html>
