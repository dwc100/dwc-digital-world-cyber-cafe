<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cyber Cafe Alerts</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<link href="dwcalert.css" rel="stylesheet">

<style>
/* Extra styling for no-alert + loading text */
.no-alert, .loading-alert {
  text-align:center;
  margin-top:40px;
  font-size:1.2rem;
  color:#666;
  padding:15px;
}

.loading-alert i {
  margin-right:8px;
  animation:spin 1.2s linear infinite;
}

@keyframes spin {
  from { transform:rotate(0deg); }
  to { transform:rotate(360deg); }
}
</style>

</head>
<body>

<div class="header">
  <i class="fa-solid fa-bell"></i> SYSTEM ALERTS
</div>

<div class="container" id="alerts-area">
  <div class="loading-alert"><i class="fa fa-spinner"></i> Please waitâ€¦ loading alerts</div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCZ6UoTAc1BxLkQtnqdq4FXxc3tSTiEZso",
  authDomain: "systemalert-c2c23.firebaseapp.com",
  projectId: "systemalert-c2c23",
  storageBucket: "systemalert-c2c23.firebasestorage.app",
  messagingSenderId: "458431925330",
  appId: "1:458431925330:web:722c4afbee90acfcca238b",
  measurementId: "G-5HVBND1F03"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const alertsArea = document.getElementById("alerts-area");

let alertCount = 0;
let loaded = false;

// Delay check for no alerts
setTimeout(() => {
  if (!loaded) {
    alertsArea.innerHTML = `
      <div class='no-alert'>
        <i class='fa fa-circle-info'></i> No alerts available. Please check daily updates.
      </div>
    `;
  }
}, 2000);

// Listen for new alerts
db.ref("alerts").on("child_added", function(snapshot) {
    const data = snapshot.val();
    alertCount++;
    loaded = true;

    // Remove loading / no-alert text
    if (alertCount === 1) {
      alertsArea.innerHTML = "";
    }

    const box = document.createElement("div");
    box.className = "alert-box alert-" + data.type;

    let icon =
        data.type === "warning" ? "exclamation-circle" :
        data.type === "danger"  ? "ban" : "info-circle";

    box.innerHTML = `
      <i class="fa fa-${icon} alert-icon"></i>
      <div class="alert-text">${data.message}</div>
    `;

    alertsArea.prepend(box);
});
</script>

</body>
</html>
